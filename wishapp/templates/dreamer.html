{% extends 'main.html' %}
{% load humanize %}

{% block dreamerslist %}
    <div class="container">
        {% if is_owner %}
            <h1>Мои желания:</h1>
        {% else %}
            <h1>Желания {{ dreamer.username }}:</h1>
        {% endif %}
        {% for desire in desire_list %}
            <div class="row">
{#            зона желания#}
                <ul class="list-group">
                    <li class="list-group-item well">{{ desire.date|naturalday }}</li>
                    <div class="desirestate-{{ desire.desire_state }}" id="desireinfo-{{ desire.id }}" style="">
                        <li class="list-group-item">{{ desire.text|safe }}</li>
                    </div>
                    <div class="hidden desire-form" id="desireform-{{ desire.id }}">
                        <form action="{% url 'editdesire' dreamer.id  desire.id %}" method="post">
                            <textarea name="desire_text" cols="155" rows="7">{{ desire.text_for_edit }}</textarea>
                            <button type="submit" class="btn btn-info glyphicon glyphicon-save" value=""></button>
                        </form>
                    </div>
                    <li class="list-group-item button">
                        <div class="row">
                            {% if is_owner %}
{#                редактирование желания#}
                                <button class="btn btn-info btn-sm edit glyphicon glyphicon-edit" id="desirebutton-{{ desire.id }}"></button>
{#                удаление желания#}
                                <form action="{% url 'deldesire' dreamer.id %}" method="post">{% csrf_token %}
                                    <input type="hidden" name="deldesire"  value={{ desire.id }}>
                                    <button type="submit"  class="btn btn-danger btn-sm delete glyphicon glyphicon-trash" value=""></button>
                                </form>
{#                архивирование желания#}
                                <form action="{% url 'backupdesire' %}" method="post">
                                    <input type="hidden" name="backupdesire"  value={{ desire.id }}>
                                    <input type="hidden" name="dreamer_id"  value={{ dreamer.id }}>
                                    <button type="submit"  class="btn btn-info btn-sm archive" value=""> В архив</button>
                                </form>
                            {% endif %}
                        </div>
                    </li>
                </ul>

{#                <div class="col-md-12 well desirestate-{{ desire.desire_state }}" id="desireinfo-{{ desire.id }}" style="">#}
{#                    <div class="date">{{ desire.date|naturalday }}<br></div>#}
{#                    {{ desire.text|safe }}#}
{#                </div>#}
{#                <div class="col-md-12 well hidden desire-form" id="desireform-{{ desire.id }}">#}
{#                    <form action="{% url 'editdesire' dreamer.id  desire.id %}" method="post">#}
{#                        <textarea name="desire_text" cols="155" rows="7">{{ desire.text_for_edit }}</textarea>#}
{#                        <button type="submit" class="btn btn-info glyphicon glyphicon-save" value=""></button>#}
{#                    </form>#}
{#                </div>#}

{#                {% if is_owner %}#}
{#                редактирование желания#}
{#                    <div class="col-md-2">#}
{#                        <button class="btn btn-info edit glyphicon glyphicon-edit" id="desirebutton-{{ desire.id }}"></button>#}
{#                    </div>#}
{#                удаление желания#}
{#                    <div class="col-md-2">#}
{#                        <form action="{% url 'deldesire' dreamer.id %}" method="post">{% csrf_token %}#}
{#                            <input type="hidden" name="deldesire"  value={{ desire.id }}>#}
{#                            <button type="submit"  class="btn btn-danger glyphicon glyphicon-trash" value=""></button>#}
{#                        </form>#}
{#                    </div>#}
{#                архивирование желания#}
{#                    <div class="col-md-2">#}
{#                        <form action="{% url 'backupdesire' %}" method="post">#}
{#                            <input type="hidden" name="backupdesire"  value={{ desire.id }}>#}
{#                            <input type="hidden" name="dreamer_id"  value={{ dreamer.id }}>#}
{#                            <button type="submit"  class="btn btn-info glyphicon glyphicon-save-file" value=""> В архив</button>#}
{#                        </form>#}
{#                    </div>#}
{#                {% endif %}#}
                {% if desire.desire_state != 1 %}
                    {% if is_loggedin %}
    {#                авторизацияпри выборе желания для покупки#}
                        <div class="col-md-2">
                            <form action="{% url 'login_for_guest' %}" method="get">
                                <input type="hidden" name="dreamer_id"  value={{ dreamer.id }}>
                                <button type="submit"  class="btn btn-info login_new_user glyphicon glyphicon-log-in" value=""></button>
                            </form>
                        </div>
                    {% endif %}
                    {% if is_choice and not is_loggedin%}
{#            выбор желания для покупки#}
                         <div class="col-md-2">
                             <form action="{% url 'selectdesire' %}" method="post">
                                 <input type="hidden" name="dreamer_id"  value={{ dreamer.id }}>
                                 <input type="hidden" name="desire_id"  value={{ desire.id }}>
                                 <input type="hidden" name="order_user_id"  value={{ user_id }}>
                                 <input type="hidden" name="order_user_name"  value={{ username }}>
                                 <input type="hidden" name="desire_desire_state"  value={{ desire.desire_state }}>
                                 <button class="btn btn-info select_desire glyphicon glyphicon-check" id="desireselect-{{ desire.id }}">
                                     Select desire</button>
                             </form>
                         </div>
                     {% endif %}
                {% elif not is_owner %}
                    <div class="col-md-8">
                        <i class="glyphicon glyphicon-ok-circle select_desire labelselect" id="labelselect-{{ desire.id }}" aria-hidden="true">
                            Selected by {{ desire.order_user_name }}</i>
                    </div>
                {% endif %}
            </div>
        {% endfor %}
        {% if is_owner %}
{#    блок добавления желаний#}
            <div class="row">
                <form action="{% url 'adddesire' dreamer.id %}" class="button" method="post" >{% csrf_token %}
                    <div class="col-md-12 well">
                        {{ form.desire_text}}
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-info glyphicon glyphicon-pencil" value=""></button>
                    </div>
                </form>
            </div>
        {% endif %}
    </div>
{% endblock %}



